<% content_for :head do %>
  <!-- Meta Description -->
  <meta name="description" content="<%= @meta_description %>">

  <!-- Open Graph Tags -->
  <meta property="og:title" content="<%= @og_title %>">
  <meta property="og:description" content="<%= @og_description %>">
  <meta property="og:url" content="<%= @og_url %>">
  <meta property="og:type" content="<%= @og_type %>">
  <meta property="og:site_name" content="DiffDaily">
  <% if @og_article_published_time.present? %>
    <meta property="article:published_time" content="<%= @og_article_published_time %>">
  <% end %>
  <% if @og_image.present? %>
    <meta property="og:image" content="<%= @og_image %>">
  <% end %>

  <!-- Twitter Card Tags -->
  <meta name="twitter:card" content="<%= @twitter_card %>">
  <meta name="twitter:title" content="<%= @twitter_title %>">
  <meta name="twitter:description" content="<%= @twitter_description %>">
  <% if @twitter_image.present? %>
    <meta name="twitter:image" content="<%= @twitter_image %>">
  <% end %>
  <!-- Twitterアカウントがある場合は追加 -->
  <%# <meta name="twitter:site" content="@your_twitter_handle"> %>
  <%# <meta name="twitter:creator" content="@your_twitter_handle"> %>
<% end %>

<% content_for :title, @page_title %>

<div class="w-full max-w-4xl mx-auto">
  <div class="mb-6">
    <%= link_to root_path, class: "text-blue-600 hover:text-blue-800 text-sm flex items-center" do %>
      <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
      </svg>
      記事一覧に戻る
    <% end %>
  </div>

  <article class="bg-white rounded-lg shadow-sm border border-gray-200 p-8">
    <header class="mb-8 border-b border-gray-200 pb-6">
      <h1 class="text-3xl font-bold text-gray-900 mb-4">
        <%= @post.title %>
      </h1>

      <div class="flex items-center text-sm text-gray-600 space-x-4">
        <time datetime="<%= @post.published_at&.iso8601 %>">
          <%= @post.published_at&.strftime("%Y年%m月%d日 %H:%M") %>
        </time>
        <span class="flex items-center">
          <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"></path>
          </svg>
          <%= @post.repository.name %>
        </span>
      </div>
    </header>

    <% if @post.source_url.present? %>
      <div class="mb-8" data-controller="link-card" data-link-card-url-value="<%= @post.source_url %>" data-link-card-label-value="記事のソース">
        <a href="<%= @post.source_url %>" target="_blank" rel="noopener" class="text-blue-600 hover:underline">
          <%= @post.source_url %>
        </a>
      </div>
    <% end %>

    <div class="prose prose-zinc prose-lg max-w-none mb-8" data-controller="syntax-highlight">
      <%= @post.to_html %>
    </div>

    <footer class="border-t border-gray-200 pt-6 mt-8">
      <div class="bg-gradient-to-br from-blue-50 to-indigo-50 rounded-lg p-5 border border-blue-100">
        <div class="flex items-center mb-3">
          <svg class="w-5 h-5 mr-2 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
          </svg>
          <h3 class="text-sm font-semibold text-gray-800">記事メタデータ</h3>
        </div>
        <dl class="text-sm text-gray-700 space-y-2">
          <% if @post.source_url.present? %>
            <div class="flex">
              <dt class="font-medium w-32 text-gray-600">Primary Source:</dt>
              <dd>
                <%= link_to @post.source_url, @post.source_url, class: "text-blue-600 hover:text-blue-800 hover:underline", target: "_blank", rel: "noopener noreferrer" %>
              </dd>
            </div>
          <% end %>
          <% if @post.generated_by.present? %>
            <div class="flex">
              <dt class="font-medium w-32 text-gray-600">Generated by:</dt>
              <dd class="text-gray-700"><%= @post.generated_by %> for DiffDaily</dd>
            </div>
          <% end %>
        </dl>
        <p class="text-xs text-gray-600 mt-4 bg-white/50 rounded p-2 border border-blue-100">
          この記事はAIによって自動生成されています。内容の正確性については、必ずソースコードやPRを確認してください。
        </p>

        <%= render partial: "posts/review_info", locals: { post: @post } %>
      </div>
    </footer>
  </article>
</div>
